# Full — OIDC app in Zitadel + Cloudflare Access + Ingress
apiVersion: access.zitadel.com/v1alpha1
kind: SecuredApplication
metadata:
  name: grafana
  namespace: monitoring
spec:
  host: grafana.example.com
  access:
    project: infrastructure
    roles:
      - admin
      - viewer
  oidc:
    redirectURIs:
      - https://grafana.example.com/login/generic_oauth
    idTokenRoleAssertion: true
    accessTokenRoleAssertion: true
  tunnel:
    backend:
      serviceName: grafana
      servicePort: 3000
  deleteProtection: true
---
# Non-OIDC app — Cloudflare Access only, no Zitadel app created
apiVersion: access.zitadel.com/v1alpha1
kind: SecuredApplication
metadata:
  name: wiki
  namespace: default
spec:
  host: wiki.example.com
  access:
    project: infrastructure
    roles:
      - admin
  tunnel:
    backend:
      serviceName: wiki
      servicePort: 8080
