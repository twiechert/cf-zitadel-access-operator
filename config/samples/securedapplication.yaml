# Minimal — CF Access protection + Zitadel app registration
apiVersion: access.twiechert.de/v1alpha1
kind: SecuredApplication
metadata:
  name: wiki
  namespace: default
spec:
  host: wiki.example.com
  access:
    project: infrastructure
    roles:
      - admin
  backend:
    serviceName: wiki
    servicePort: 8080
---
# Native OIDC — app handles its own OAuth (e.g. Grafana) with a direct Ingress
apiVersion: access.twiechert.de/v1alpha1
kind: SecuredApplication
metadata:
  name: grafana
  namespace: monitoring
spec:
  host: grafana.example.com
  access:
    project: infrastructure
    roles:
      - admin
      - viewer
  backend:
    serviceName: grafana
    servicePort: 3000
  nativeOIDC:
    redirectPath: /login/generic_oauth
    idTokenRoleAssertion: true
    accessTokenRoleAssertion: true
    clientSecretRef: grafana-oidc
    ingress:
      host: grafana-internal.example.com
      className: nginx
  deleteProtection: true
